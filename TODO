[ TODO list and tentative development plan ]
[ // = done, but not tested/documented     ]

// * an easy way to change colors of all datasets, eg. using colorramp 

* optimize data transformations (all-points operations):
   calculate max. stack size (ss) from bytecode
   alloc stack for all points (M*ss)
   change how code execution works: all points should be handled at once

* user defined functions:
      - default parameter values can take any expression...
      // - syntax:
      //   --> define Gaussian(a,pos,width): a*exp(-((x-pos)/width)^2)
      //                  ^^^ any name but 'x' allowed here
      - more sophisticated simplifications of expressions and CSE(!)
      - f(x) = a1*(a2/x)^3*exp(-(((a2/x)-a3)/a4)^2) / x 
         (Maxwell-Boltzmann velocity (flux) distribution
	  for Wolfgang Christen)

// * (GUI) new Fit->Run dialog (one dialog with max. WSSR evaluations,
//   max. iterations, continue checkbox, OK/Cancel)

* "info" can be redirected to file in every case
   ("info ... >> file" appends to file, with '>' it truncates file)

* (GUI) peak-tops should be visible also in range-mode

// * (GUI) added peak should be activeted

// * (GUI) access to pop-up menus (plots, output window) from menubar

* command "$_3 = ~0.151686" should not change "auto" flag of $_3 
  perhaps all variables starting with "_" should be removed
  when not used anymore?

// * fitting:  maximum lambda as stopping criterium for LM

* [BUG] "fit; delete %foo; fit+" causes crash

------------------ next release here 0.7.5
* ?? un-strip background: append proper 'in @n' (not the one used for strip),

* (GUI) finish script debugger dialog

* (GUI) peak dragging -- sensible scaling of parameter changes 
           (problems with width changing)
 	(bug?) now it matters in which point exactly you catch the peak

* user defined functions:
      - calculating limits, width, area, etc. for UDF(!)

* link to "On-line tutorial" and the tutorial itself(!)
   perhaps screencast (eg. using Wink)

* EMG function: how to calculate it? Now there are some problems with
  this function. There must be smarter way to implement it...

* Should y=0 be visible when doing plot [] [] ? 
  Perhaps one (which?) of "plot . []" and "plot . [:]" should show y=0,
  the other one not? what about plot . [:30]?
   -> by default, auto-scaling does not include x/y=0, unless it's
      in, say, 20% plot margin. "[:]" is an exception and includes 0.

* use info for exports:
  - replace exporting @x.peaks, @x.formula and commands[] 
    with info ... > filename
     - what about @*.formula, what about data titles in headers
  - (?) "info @n () > file"
       should display ... [1234 lines more] rather than everything

* GUI: data range mode: special mode to dis-activate points below 
  given level or polyline; or (dis)activate with rectangle

* simple-variable domain ~3[2:14]

* settings: Nelder-Mead and GA fitting options, 
  a way to "shake" parameters for L-M
  constrained L-M option

* history (data / sum / view / all) 
   i don't exactly know how to implement it yet

* implement command "dump", which also embeds data in script using
   M=..., x[0]=.., y[0]=.., s[0]=..., a[0]=.., x[1]=..,...

* BUG: "reset" doesn't deletes functions and variables, it should also
  replot in GUI and reset automatic func/var counter.

* (GUI) redrawing for many datasets (~100) takes noticable time.
  Kind of plot buffering (as a bitmap).

------------------ next release here 0.7.6

* build engine (everything but GUI/CLI interface) as a library
  with more or less documented API.

------------------ next release here 0.8.0

* python scripts  -- built-in Python interpreter which allows to extend 
  Fityk using user-written scripts, optional modules, etc. 
  [IMPORTANT]

* rewrite crystallographic part in python
  [IMPORTANT]

------------------ next release here 

* [BUG]: program crashes (MS Win 9x) when data contains NaN (as a result
  of asin(x) x>1) and "Zoom all" is called.

* (GUI) data-range mode: if all points are active, left mouse button
  should "select", not "activate", ie. it should do A = (left<x<right)  (?)

* (GUI) when printing, everything is first rescaled and rounded(!!!) for
  plot window at the screen, and then rescaled to the paper size. 
  This rounding causes visible artefacts at the printout.
  (wxDC.GetSize instead of plot.GetClientSize() ?)

* info -- more informations about error, confidence limits, etc.
  graphical interface Fit > Info

* (GUI) Configurable status bar:
	  more extensive and configurable (2/3 buttons, size) mouse hints 
		   (also for aux. plot, etc)
	  more exact (or customizable) y coordinate at status bar
	  [^] (Shift) in status line hints; pressing Shift should update
	  hints

* (GUI) vertical scaling using mouse on main plot near to left edge of the plot 

* GUI [BUG] aux. plot - when program is called with script as an argument
   aux. plot looks strange at the start of the program until it is replotted

* improve Voigt function (cut-tails, better approx?) 

* (GUI) use numeric pad keys (WXK_NUMPAD_*) as shortcuts for changing 
	function parameters.

* GUI: it should be possible to constrain two parameters of two peak,
     at least to make them equal.

* GUI: easy way to do: F[hwhm]=..., F[shape]=...;

* GUI: button 'freeze' on variables pane

* Fitting 
	simulated annealing (it can replace LM shake_before option)
	perhaps also BFGS, conjugate gradients methods
	autoplot option -> fitting tab, checkbox: replot-after-fit-iteration
	                   perhaps also in Fit->Run dialog

* GUI: menu Functions:
  Functions > Peak-Find Info -> animation
  Functions > Multidata P-F Info -> window with list of parameters (Xview-like)

* Function: check_parameters_out_of_domain() ?  
             eg. in Pearson shape > 0.5 , shape < 1e9
	     called from fitting iteration?
	     what if parameter is out-of-domain? change? disable function?
	                                          change and freeze?
	     set fit-fix-parameters-times = 5
	    simple-var bounds?
	    ? $$simple = ~{min2(max2($simple, -1e9), 1e9)}

* GUI: Data Editor - left/right/top/bottom - magic keywords: user would be
       asked to select point/range/rectangle in plot

* cmd/GUI: plot peak-groups: ==> plot (%a+%b+%c)  

* (GUI) different peak-draft for steps (new function category), 
         and for other functions

* (GUI) where config files should be stored on MS Windows? Registry or file?

* (INTERNAL) use smart pointers: 
  http://www.boost.org/libs/smart_ptr/smart_ptr.htm
  (the library will be distributed in 3rdparty/boost)

* there are problems with refreshing plots and output window when program
  is busy (ie. when running script or fitting). It seems to be platform
  dependent.

* auto-freezing of peaks at disactivated range

* loading data -- use Difdaf library (when it will be ready) for powder
  diffraction data import.
  other formats (from survey): .jdx JCAMP-DX (www.jcamp.org)
		         Galactic (GRAMS/32) SPC files (especially multifiles)
			 Vamas (vms), 
			 multipart Siemens .raw data files
			 uxd,udf
  perhaps OPJ with liborigin and XLS with another library

* (GUI) single dialog for configuring main plot(?)
  data point size and other properties can be put on data pane(?)

* (GUI, BUG) in Configure axes / peak labels: fonts are changed event
  if Apply is not pressed

* (GUI) stopping fitting interactively (when user don't want to wait longer);
  use threads? or wxTimer?

* automatic background substraction - what are good algorithms?

* more sophisticated algorithms for peak detection

* fitting: it should be separated even more from the rest of the program.
  Perhaps it fitting functions should be in extern library (COOOL,
  GAUL, WNLIB, netlib, OOL.sf.net
  are there any other such libraries? 
  I haven't investigated the possibility of using mentioned libs yet. 
  Links: http://coool.mines.edu/ http://gaul.sourceforge.net/, 
  http://www.willnaylor.com/wnlib.html,
  http://sal.jyu.fi/B/3/index.shtml, http://coin-or.org,
  http://www-unix.mcs.anl.gov/otc/Guide/faq/nonlinear-programming-faq.html) 

* fitting: robust fit - other error distributions then Gaussian, 
  eg. Lorenzian...; so called 'maximum-likelihood method' -- using Poisson
  error distribution.

* Now only '.' is supported as a decimal separator. ',' should also
  be an option.

* investigate LLVM - can it be used for faster calculation of 
  user-defined functions?

* [BUG] (GUI) (MS Win) <br> does not work in vertical peak labels 

